<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Configuration file - Spotifyd</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../Introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="../installation/index.html"><strong aria-hidden="true">1.</strong> Installation Instructions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../installation/Raspberry-Pi.html"><strong aria-hidden="true">1.1.</strong> Installing on a Raspberry Pi</a></li><li class="chapter-item expanded "><a href="../installation/Ubuntu.html"><strong aria-hidden="true">1.2.</strong> Installing on Ubuntu (from source)</a></li><li class="chapter-item expanded "><a href="../installation/Cross-Compiling-on-Ubuntu.html"><strong aria-hidden="true">1.3.</strong> Cross Compiling on Ubuntu</a></li><li class="chapter-item expanded "><a href="../installation/MacOS.html"><strong aria-hidden="true">1.4.</strong> Installing with Homebrew on macOS</a></li><li class="chapter-item expanded "><a href="../installation/FreeBSD.html"><strong aria-hidden="true">1.5.</strong> Installing on FreeBSD</a></li></ol></li><li class="chapter-item expanded "><a href="../config/index.html"><strong aria-hidden="true">2.</strong> Configuration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../config/Cli.html"><strong aria-hidden="true">2.1.</strong> CLI options</a></li><li class="chapter-item expanded "><a href="../config/File.html" class="active"><strong aria-hidden="true">2.2.</strong> Configuration file</a></li><li class="chapter-item expanded "><a href="../config/services/index.html"><strong aria-hidden="true">2.3.</strong> Running as a Service</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../config/services/Systemd.html"><strong aria-hidden="true">2.3.1.</strong> Running as systemd service</a></li><li class="chapter-item expanded "><a href="../config/services/MacOS.html"><strong aria-hidden="true">2.3.2.</strong> Running as launchd service (MacOS)</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Spotifyd</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#configuration-file" id="configuration-file">Configuration file</a></h1>
<p><code>Spotifyd</code> is able to load configuration values from a <a href="https://toml.io/en/v0.5.0">TOML</a> file too. The file has to be named <code>spotifyd.conf</code> and reside in the user's configuration directory (<code>~/.config/spotifyd</code>) or the system configuration directory (<code>/etc</code> or <code>/etc/xdg/spotifyd</code>). This also applies to macOS!</p>
<p>The configuration file consists of two sections, <code>global</code> and <code>spotifyd</code>, whereas <code>spotifyd</code> takes priority over <code>global</code>.</p>
<p>The configuration file has the following format:</p>
<pre><code class="language-toml">[global]
# Your Spotify account name.
username = &quot;username&quot;

# Your Spotify account password.
password = &quot;password&quot;

# A command that gets executed and can be used to
# retrieve your password.
# The command should return the password on stdout.
#
# This is an alternative to the `password` field. Both
# can't be used simultaneously.
password_cmd = &quot;command_that_writes_password_to_stdout&quot;

# If set to true, `spotifyd` tries to look up your
# password in the system's password storage.
#
# Note, that the `password` field will take precedence, if set.
use_keyring = true

# If set to true, `spotifyd` tries to bind to dbus (default is the session bus)
# and expose MPRIS controls. When running headless, without the session bus,
# you should set this to false, to avoid errors. If you still want to use MPRIS,
# have a look at the `dbus_type` option.
use_mpris = true

# The bus to bind to with the MPRIS interface.
# Possible values: &quot;session&quot;, &quot;system&quot;
# The system bus can be used if no graphical session is available
# (e.g. on headless systems) but you still want to be able to use MPRIS.
# NOTE: You might need to add appropriate policies to allow spotifyd to
# own the name.
dbus_type = &quot;session&quot;

# The audio backend used to play music. To get
# a list of possible backends, run `spotifyd --help`.
backend = &quot;alsa&quot; # use portaudio for macOS [homebrew]

# The alsa audio device to stream audio. To get a
# list of valid devices, run `aplay -L`,
device = &quot;alsa_audio_device&quot;  # omit for macOS

# The PCM sample format to use. Possible values 
# are F32, S32, S24, S24_3, S16. 
# Change this value if you encounter errors like
# &quot;Alsa error PCM open ALSA function 'snd_pcm_hw_params_set_format' failed with error 'EINVAL: Invalid argument'&quot;
audio_format = &quot;S16&quot;

# The alsa control device. By default this is the same
# name as the `device` field.
control = &quot;alsa_audio_device&quot;  # omit for macOS

# The alsa mixer used by `spotifyd`.
mixer = &quot;PCM&quot;  # omit for macOS

# The volume controller. Each one behaves different to
# volume increases. For possible values, run
# `spotifyd --help`.
volume_controller = &quot;alsa&quot;  # use softvol for macOS

# A command that gets executed in your shell after each song changes.
on_song_change_hook = &quot;command_to_run_on_playback_events&quot;

# The name that gets displayed under the connect tab on
# official clients. Spaces are not allowed!
device_name = &quot;device_name_in_spotify_connect&quot;

# The audio bitrate. 96, 160 or 320 kbit/s
bitrate = 160

# The directory used to cache audio data. This setting can save
# a lot of bandwidth when activated, as it will avoid re-downloading
# audio files when replaying them.
#
# Note: The file path does not get expanded. Environment variables and
# shell placeholders like $HOME or ~ don't work!
cache_path = &quot;cache_directory&quot;

# The maximal size of the cache directory in bytes
# The example value corresponds to ~ 1GB
max_cache_size = 1000000000

# If set to true, audio data does NOT get cached.
no_audio_cache = true

# Volume on startup between 0 and 100
# NOTE: This variable's type will change in v0.4, to a number (instead of string)
initial_volume = &quot;90&quot;

# If set to true, enables volume normalisation between songs.
volume_normalisation = true

# The normalisation pregain that is applied for each song.
normalisation_pregain = -10

# After the music playback has ended, start playing similar songs based on the previous tracks.
autoplay = true

# The port `spotifyd` uses to announce its service over the network.
zeroconf_port = 1234

# The proxy `spotifyd` will use to connect to spotify.
proxy = &quot;http://proxy.example.org:8080&quot;

# The displayed device type in Spotify clients.
# Can be unknown, computer, tablet, smartphone, speaker, t_v,
# a_v_r (Audio/Video Receiver), s_t_b (Set-Top Box), and audio_dongle.
device_type = &quot;speaker&quot;
</code></pre>
<h2><a class="header" href="#alternatives-to-storing-your-password-in-the-config-file----omit-in-toc---" id="alternatives-to-storing-your-password-in-the-config-file----omit-in-toc---">Alternatives to storing your password in the config file <!-- omit in toc --></a></h2>
<ul>
<li>
<p>use zeroconf authentication from Spotify Connect</p>
<p>Spotifyd is able to advertise itself on the network without credentials. To enable this, you must omit / comment any <code>username</code> / <code>username_cmd</code> or <code>password</code> / <code>password_cmd</code> in the configuration. Spotifyd will receive an authentication blob from Spotify when you choose it from the devices list.</p>
<blockquote>
<p><strong>Note:</strong> If you choose to go with this, it is also recommended to omit the <code>cache_path</code> and <code>cache_directory</code> options. Otherwise the first user to connect to the service will have its authentication blob cached by the service and nobody else will be able to connect to the service without clearing the cache.</p>
</blockquote>
<p>This way, a Spotifyd instance can also be made available to multiple users.</p>
<p>For more information, have a look at the <a href="https://github.com/librespot-org/librespot/blob/master/docs/authentication.md#zeroconf-based-authentication">librespot documentation</a>.</p>
</li>
<li>
<p><strong><code>password_cmd</code></strong> config entry</p>
<p>This feature allows you to provide a command that prints your password to <code>stdout</code>, which saves you from having to store your password in the config file directly. To use it, set the <code>password_cmd</code> config entry to the command you would like to use and remove the <code>password</code> config entry.</p>
<p>For example (using the password-management utility <a href="https://www.passwordstore.org/">pass</a>).</p>
<pre><code class="language-toml"># ~/.config/spotifyd/spotifyd.conf
password_cmd = &quot;pass spotify&quot;
</code></pre>
</li>
<li>
<p><strong><code>use_keyring</code></strong> config entry / <strong><code>--use-keyring</code></strong> CLI flag <!-- omit in toc --></p>
<p>This features leverages <a href="https://www.freedesktop.org/wiki/Specifications/secret-storage-spec/">Linux's DBus Secret Service API</a> or native macOS keychain in order to forgo the need to store your password directly in the config file. To use it, compile with the <code>dbus_keyring</code> feature and set the <code>use-keyring</code> config entry to <code>true</code> or pass the <code>--use-keyring</code> CLI flag  during start to the daemon. Remove the <code>password</code> and/or <code>password_cmd</code> config entries.</p>
<p>Your keyring entry needs to have the following attributes set:</p>
<pre><code class="language-yaml">application: rust-keyring
service: spotifyd
username: &lt;your-spotify-username&gt;
</code></pre>
<p>To add such an entry into your keyring, you can use <code>secret-tool</code>, a CLI used to communicate with agents that support the Secret Service API:</p>
<pre><code class="language-bash">secret-tool store --label='name you choose' application rust-keyring service spotifyd username &lt;your-username&gt;
</code></pre>
<p>You can use the keychain GUI on macOS to add an item respectively, or with the built-in <code>security</code> tool:</p>
<pre><code class="language-bash">security add-generic-password -s spotifyd -D rust-keyring -a &lt;your username&gt; -w
</code></pre>
</li>
</ul>
<h2><a class="header" href="#shell-used-to-run-commands-indicated-by-password_cmd-or-on_song_changed_hook----omit-in-toc---" id="shell-used-to-run-commands-indicated-by-password_cmd-or-on_song_changed_hook----omit-in-toc---">Shell used to run commands indicated by <code>password_cmd</code> or <code>on_song_changed_hook</code> <!-- omit in toc --></a></h2>
<p>If either of these options is given, the shell <code>spotifyd</code> will use to run its commands is the shell indicated by the <code>SHELL</code> environment variable, if set. If the <code>SHELL</code> environment variable is not set, <code>spotifyd</code> will use the user's default shell, which, on Linux and BSD, is the shell listed in <code>/etc/passwd</code>. On macOS it is the shell listed in the output of <code>dscl . -read /Users/&lt;username&gt; UserShell</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../config/Cli.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../config/services/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../config/Cli.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../config/services/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
